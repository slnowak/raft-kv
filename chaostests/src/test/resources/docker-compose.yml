version: '2'

services:
  node1:
    image: test
    ports:
      - "9091:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.101:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.101
  survivor_node2:
    image: test
    ports:
      - "9092:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.102:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.102
  node3:
    image: test
    ports:
      - "9093:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.103:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.103
  node4:
    image: test
    ports:
      - "9094:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.104:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.104
  node5:
    image: test
    ports:
      - "9095:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.105:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.105
  survivor_node6:
    image: test
    ports:
      - "9096:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.106:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.106
  node7:
    image: test
    ports:
      - "9097:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.107:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.107
  node8:
    image: test
    ports:
      - "9098:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.108:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.108
  node9:
    image: test
    ports:
      - "9099:9091"
    environment:
      - CLUSTER_BINDING_ADDRESS=192.168.16.109:9090
      - INITIAL_CLUSTER_NODES=192.168.16.101:9090;192.168.16.102:9090;192.168.16.103:9090;192.168.16.104:9090;192.168.16.105:9090;192.168.16.106:9090;192.168.16.107:9090;192.168.16.108:9090;192.168.16.109:9090
    networks:
      copycat:
        ipv4_address: 192.168.16.109

networks:
  copycat:
    driver: bridge
    ipam:
      config:
      - subnet: 192.168.16.0/20